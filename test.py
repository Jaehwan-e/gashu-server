from app.services.apis import fetch_bus_directions, search_address_by_keyword, geocode_address,fetch_realtime_bus_info, fetch_realtime_node_info

dep_coord = (127.443867, 36.630563)  # 출발지 좌표
dest_coord = (127.491279556299, 36.6369449145635)  # 목적지 좌표

directions = fetch_bus_directions(dep_coord, dest_coord)
print(directions)

# address = "충북 청주시 서원구 개신동 12"
# coord = geocode_address(address)
# print(coord)

# node_id = "CJB271000130"
# route_id = "CJB270016200"
# realtime_info = fetch_realtime_node_info(node_id)
# print(realtime_info)


# import os
# from dotenv import load_dotenv
# from openai import OpenAI

# # .env 파일에서 API 키 로딩
# load_dotenv()
# api_key = os.getenv("OPENAI_API_KEY")

# # OpenAI 클라이언트 초기화
# client = OpenAI(api_key=api_key)

# def ask_gpt(message: str) -> str:
#     response = client.chat.completions.create(
#         model="gpt-4o",
#         messages=[
#             {"role": "system", "content": "너는 json 형식의 데이터를 요약해서 반환하는 역할을 해야 해."},
#             {"role": "user", "content": message}
#         ],
#         temperature=0.0,
#     )
#     return response.choices[0].message.content.strip()

# message = """
# 다음의 경로를 보고 같은 경로라면 버스번호를 배열로 묶어 하나의 경로로 변환 후 반환해줘
# 경로: [{'total_time': 17, 'fare': 1650, 'transfer_count': 0, 'total_walk_time': 3, 'bus_routes': [{'route_name': '간선:105', 'start_station': '복대가경시장', 'end_station': '청주대교', 'start_nodeid': 'CJB271000127'}], 'walk_segments': [{'type': 'start_to_station', 'distance': 286, 'time': 3, 'start_name': '출발지', 'end_name': '복대가경시장'}, {'type': 'station_to_dest', 'distance': 66, 'time': 0, 'start_name': '청주대교', 'end_name': '도착지'}]}, {'total_time': 18, 'fare': 1650, 'transfer_count': 0, 'total_walk_time': 3, 'bus_routes': [{'route_name': '간선:833', 'start_station': '복대가경시장', 'end_station': '지하상가', 'start_nodeid': 'CJB271000127'}], 'walk_segments': [{'type': 'start_to_station', 'distance': 286, 'time': 3, 'start_name': '출발지', 'end_name': '복대가경시장'}, {'type': 'station_to_dest', 'distance': 74, 'time': 0, 'start_name': '지하상가', 'end_name': '도착지'}]}, {'total_time': 17, 'fare': 1650, 'transfer_count': 0, 'total_walk_time': 4, 'bus_routes': [{'route_name': '간선:511', 'start_station': '서원초등학교', 'end_station': '청주대교', 'start_nodeid': 'CJB271000130'}], 'walk_segments': [{'type': 'start_to_station', 'distance': 364, 'time': 4, 'start_name': '출발지', 'end_name': '서원초등학교'}, {'type': 'station_to_dest', 'distance': 66, 'time': 0, 'start_name': '청주대교', 'end_name': '도착지'}]}, {'total_time': 19, 'fare': 2050, 'transfer_count': 0, 'total_walk_time': 8, 'bus_routes': [{'route_name': '급행:509', 'start_station': '죽천교', 'end_station': '지하상가', 'start_nodeid': 'CJB271000122'}], 'walk_segments': [{'type': 'start_to_station', 'distance': 623, 'time': 8, 'start_name': '출발지', 'end_name': '죽천교'}, {'type': 'station_to_dest', 'distance': 74, 'time': 0, 'start_name': '지하상가', 'end_name': '도착지'}]}, {'total_time': 17, 'fare': 3300, 'transfer_count': 1, 'total_walk_time': 4, 'bus_routes': [{'route_name': '간선:833', 'start_station': '서원초등학교', 'end_station': '청주체육관', 'start_nodeid': 'CJB271000130'}, {'route_name': '순환:40-2', 'start_station': '청주체육관', 'end_station': '청주대교', 'start_nodeid': 'CJB283000026'}], 'walk_segments': [{'type': 'start_to_station', 'distance': 364, 'time': 4, 'start_name': '출발지', 'end_name': '서원초등학교'}, {'type': 'transfer', 'distance': 0, 'time': 0, 'start_name': '청주체육관', 'end_name': '청주체육관'}, {'type': 'station_to_dest', 'distance': 66, 'time': 0, 'start_name': '청주대교', 'end_name': '도착지'}]}, {'total_time': 24, 'fare': 3700, 'transfer_count': 1, 'total_walk_time': 6, 'bus_routes': [{'route_name': '간선:311', 'start_station': '복대가경시장', 'end_station': '고속버스터미널', 'start_nodeid': 'CJB271000126'}, {'route_name': '급행:509', 'start_station': '고속버스터미널', 'end_station': '지하상가', 'start_nodeid': 'CJB271000065'}], 'walk_segments': [{'type': 'start_to_station', 'distance': 472, 'time': 6, 'start_name': '출발지', 'end_name': '복대가경시장'}, {'type': 'transfer', 'distance': 0, 'time': 0, 'start_name': '고속버스터미널', 'end_name': '고속버스터미널'}, {'type': 'station_to_dest', 'distance': 74, 'time': 0, 'start_name': '지하상가', 'end_name': '도착지'}]}, {'total_time': 22, 'fare': 3300, 'transfer_count': 1, 'total_walk_time': 5, 'bus_routes': [{'route_name': '간선:618', 'start_station': '서원초등학교', 'end_station': '사직1동행정복지센터', 'start_nodeid': 'CJB271000130'}, {'route_name': '순환:30-1', 'start_station': '사직1동행정복지센터', 'end_station': '청주대교', 'start_nodeid': 'CJB283000022'}], 'walk_segments': [{'type': 'start_to_station', 'distance': 364, 'time': 4, 'start_name': '출발지', 'end_name': '서원초등학교'}, {'type': 'transfer', 'distance': 66, 'time': 1, 'start_name': '사직1동행정복지센터', 'end_name': '사직1동행정복지센터'}, {'type': 'station_to_dest', 'distance': 66, 'time': 0, 'start_name': '청주대교', 'end_name': '도착지'}]}, {'total_time': 28, 'fare': 3300, 'transfer_count': 1, 'total_walk_time': 6, 'bus_routes': [{'route_name': '간선:311', 'start_station': '복대가경시장', 'end_station': '고속버스터미널', 'start_nodeid': 'CJB271000126'}, {'route_name': '간선:511', 'start_station': '고속버스터미널', 'end_station': '청주대교', 'start_nodeid': 'CJB271000065'}], 'walk_segments': [{'type': 'start_to_station', 'distance': 472, 'time': 6, 'start_name': '출발지', 'end_name': '복대가경시장'}, {'type': 'transfer', 'distance': 0, 'time': 0, 'start_name': '고속버스터미널', 'end_name': '고속버스터미널'}, {'type': 'station_to_dest', 'distance': 66, 'time': 0, 'start_name': '청주대교', 'end_name': '도착지'}]}, {'total_time': 29, 'fare': 3300, 'transfer_count': 1, 'total_walk_time': 5, 'bus_routes': [{'route_name': '간선:710', 'start_station': '서원초등학교', 'end_station': '청주우편집중국', 'start_nodeid': 'CJB271000130'}, {'route_name': '순환:30-2', 'start_station': '청주우편집중국', 'end_station': '지하상가', 'start_nodeid': 'CJB283000004'}], 'walk_segments': [{'type': 'start_to_station', 'distance': 364, 'time': 4, 'start_name': '출발지', 'end_name': '서원초등학교'}, {'type': 'transfer', 'distance': 0, 'time': 0, 'start_name': '청주우편집중국', 'end_name': '청주우편집중국'}, {'type': 'station_to_dest', 'distance': 96, 'time': 1, 'start_name': '지하상가', 'end_name': '도착지'}]}, {'total_time': 27, 'fare': 3300, 'transfer_count': 1, 'total_walk_time': 5, 'bus_routes': [{'route_name': '순환:20-2', 'start_station': '서원초등학교', 'end_station': '서청주우체국', 'start_nodeid': 'CJB271000098'}, {'route_name': '간선:917', 'start_station': '서청주우체국', 'end_station': '지하상가', 'start_nodeid': 'CJB271000107'}], 'walk_segments': [{'type': 'start_to_station', 'distance': 400, 'time': 5, 'start_name': '출발지', 'end_name': '서원초등학교'}, {'type': 'transfer', 'distance': 0, 'time': 0, 'start_name': '서청주우체국', 'end_name': '서청주우체국'}, {'type': 'station_to_dest', 'distance': 74, 'time': 0, 'start_name': '지하상가', 'end_name': '도착지'}]}][{'total_time': 17, 'fare': 1650, 'transfer_count': 0, 'total_walk_time': 3, 'bus_routes': [{'route_name': '간선:105', 'start_station': '복대가경시장', 'end_station': '청주대교', 'start_nodeid': 'CJB271000127'}], 'walk_segments': [{'type': 'start_to_station', 'distance': 286, 'time': 3, 'start_name': '출발지', 'end_name': '복대가경시장'}, {'type': 'station_to_dest', 'distance': 66, 'time': 0, 'start_name': '청주대교', 'end_name': '도착지'}]}, {'total_time': 18, 'fare': 1650, 'transfer_count': 0, 'total_walk_time': 3, 'bus_routes': [{'route_name': '간선:833', 'start_station': '복대가경시장', 'end_station': '지하상가', 'start_nodeid': 'CJB271000127'}], 'walk_segments': [{'type': 'start_to_station', 'distance': 286, 'time': 3, 'start_name': '출발지', 'end_name': '복대가경시장'}, {'type': 'station_to_dest', 'distance': 74, 'time': 0, 'start_name': '지하상가', 'end_name': '도착지'}]}, {'total_time': 17, 'fare': 1650, 'transfer_count': 0, 'total_walk_time': 4, 'bus_routes': [{'route_name': '간선:511', 'start_station': '서원초등학교', 'end_station': '청주대교', 'start_nodeid': 'CJB271000130'}], 'walk_segments': [{'type': 'start_to_station', 'distance': 364, 'time': 4, 'start_name': '출발지', 'end_name': '서원초등학교'}, {'type': 'station_to_dest', 'distance': 66, 'time': 0, 'start_name': '청주대교', 'end_name': '도착지'}]}, {'total_time': 19, 'fare': 2050, 'transfer_count': 0, 'total_walk_time': 8, 'bus_routes': [{'route_name': '급행:509', 'start_station': '죽천교', 'end_station': '지하상가', 'start_nodeid': 'CJB271000122'}], 'walk_segments': [{'type': 'start_to_station', 'distance': 623, 'time': 8, 'start_name': '출발지', 'end_name': '죽천교'}, {'type': 'station_to_dest', 'distance': 74, 'time': 0, 'start_name': '지하상가', 'end_name': '도착지'}]}, {'total_time': 17, 'fare': 3300, 'transfer_count': 1, 'total_walk_time': 4, 'bus_routes': [{'route_name': '간선:833', 'start_station': '서원초등학교', 'end_station': '청주체육관', 'start_nodeid': 'CJB271000130'}, {'route_name': '순환:40-2', 'start_station': '청주체육관', 'end_station': '청주대교', 'start_nodeid': 'CJB283000026'}], 'walk_segments': [{'type': 'start_to_station', 'distance': 364, 'time': 4, 'start_name': '출발지', 'end_name': '서원초등학교'}, {'type': 'transfer', 'distance': 0, 'time': 0, 'start_name': '청주체육관', 'end_name': '청주체육관'}, {'type': 'station_to_dest', 'distance': 66, 'time': 0, 'start_name': '청주대교', 'end_name': '도착지'}]}, {'total_time': 24, 'fare': 3700, 'transfer_count': 1, 'total_walk_time': 6, 'bus_routes': [{'route_name': '간선:311', 'start_station': '복대가경시장', 'end_station': '고속버스터미널', 'start_nodeid': 'CJB271000126'}, {'route_name': '급행:509', 'start_station': '고속버스터미널', 'end_station': '지하상가', 'start_nodeid': 'CJB271000065'}], 'walk_segments': [{'type': 'start_to_station', 'distance': 472, 'time': 6, 'start_name': '출발지', 'end_name': '복대가경시장'}, {'type': 'transfer', 'distance': 0, 'time': 0, 'start_name': '고속버스터미널', 'end_name': '고속버스터미널'}, {'type': 'station_to_dest', 'distance': 74, 'time': 0, 'start_name': '지하상가', 'end_name': '도착지'}]}, {'total_time': 22, 'fare': 3300, 'transfer_count': 1, 'total_walk_time': 5, 'bus_routes': [{'route_name': '간선:618', 'start_station': '서원초등학교', 'end_station': '사직1동행정복지센터', 'start_nodeid': 'CJB271000130'}, {'route_name': '순환:30-1', 'start_station': '사직1동행정복지센터', 'end_station': '청주대교', 'start_nodeid': 'CJB283000022'}], 'walk_segments': [{'type': 'start_to_station', 'distance': 364, 'time': 4, 'start_name': '출발지', 'end_name': '서원초등학교'}, {'type': 'transfer', 'distance': 66, 'time': 1, 'start_name': '사직1동행정복지센터', 'end_name': '사직1동행정복지센터'}, {'type': 'station_to_dest', 'distance': 66, 'time': 0, 'start_name': '청주대교', 'end_name': '도착지'}]}, {'total_time': 28, 'fare': 3300, 'transfer_count': 1, 'total_walk_time': 6, 'bus_routes': [{'route_name': '간선:311', 'start_station': '복대가경시장', 'end_station': '고속버스터미널', 'start_nodeid': 'CJB271000126'}, {'route_name': '간선:511', 'start_station': '고속버스터미널', 'end_station': '청주대교', 'start_nodeid': 'CJB271000065'}], 'walk_segments': [{'type': 'start_to_station', 'distance': 472, 'time': 6, 'start_name': '출발지', 'end_name': '복대가경시장'}, {'type': 'transfer', 'distance': 0, 'time': 0, 'start_name': '고속버스터미널', 'end_name': '고속버스터미널'}, {'type': 'station_to_dest', 'distance': 66, 'time': 0, 'start_name': '청주대교', 'end_name': '도착지'}]}, {'total_time': 29, 'fare': 3300, 'transfer_count': 1, 'total_walk_time': 5, 'bus_routes': [{'route_name': '간선:710', 'start_station': '서원초등학교', 'end_station': '청주우편집중국', 'start_nodeid': 'CJB271000130'}, {'route_name': '순환:30-2', 'start_station': '청주우편집중국', 'end_station': '지하상가', 'start_nodeid': 'CJB283000004'}], 'walk_segments': [{'type': 'start_to_station', 'distance': 364, 'time': 4, 'start_name': '출발지', 'end_name': '서원초등학교'}, {'type': 'transfer', 'distance': 0, 'time': 0, 'start_name': '청주우편집중국', 'end_name': '청주우편집중국'}, {'type': 'station_to_dest', 'distance': 96, 'time': 1, 'start_name': '지하상가', 'end_name': '도착지'}]}, {'total_time': 27, 'fare': 3300, 'transfer_count': 1, 'total_walk_time': 5, 'bus_routes': [{'route_name': '순환:20-2', 'start_station': '서원초등학교', 'end_station': '서청주우체국', 'start_nodeid': 'CJB271000098'}, {'route_name': '간선:917', 'start_station': '서청주우체국', 'end_station': '지하상가', 'start_nodeid': 'CJB271000107'}], 'walk_segments': [{'type': 'start_to_station', 'distance': 400, 'time': 5, 'start_name': '출발지', 'end_name': '서원초등학교'}, {'type': 'transfer', 'distance': 0, 'time': 0, 'start_name': '서청주우체국', 'end_name': '서청주우체국'}, {'type': 'station_to_dest', 'distance': 74, 'time': 0, 'start_name': '지하상가', 'end_name': '도착지'}]}]
# 다른 말은 하지 말고 그냥 배열 형식으로 반환해
# """

# result = ask_gpt(message)
# print(result)